<?xml version="1.0"?>
<xsl:stylesheet
     version="1.0"
     xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output indent="yes" method="text" encoding="utf-8"/>

<xsl:param name='ns' select='/parameters/@namespace'/>

<xsl:template match="/">
/*********************************************************
 * AUTOGENERATED with ecuxml2java.xsl!
 * DO NOT EDIT WITH HANDS!
 *********************************************************/
package com.mympgtracker.ecutracker.ecu.comm.ELM.toyota;

import com.mympgtracker.ecutracker.ecu.comm.ELM.ELMProtocolHandler;
import com.mympgtracker.ecutracker.ecu.comm.ELM.ELMParameter;
import com.mympgtracker.ecutracker.ecu.param.ParameterRegistry;
import com.mympgtracker.ecutracker.ecu.param.OneParamMetaParameter;
import java.io.InputStream;

/**
  List of PIDs generated:
<xsl:apply-templates select='/parameters/parameter' mode='list'/>
*/
public class ToyotaELMProtocolHandler extends ELMProtocolHandler
{

	public ToyotaELMProtocolHandler() throws Exception
	{
		super();
	}

	protected void addCoreParameters(ParameterRegistry pReg) throws Exception
	{
		super.addCoreParameters(pReg);

		<xsl:apply-templates select='/parameters/parameter'/>

		pReg.add(new OneParamMetaParameter("INJECTOR_PULSE_WIDTH_MS", pReg.get("toyota.InjectorPulseWidth"))
		{
			public double getValue() { return p1_.getValue(); }
		});
	}

}

</xsl:template>

<xsl:template match='parameter'>
		pReg.add(new GeneratedParameter("<xsl:value-of select='$ns'/>.<xsl:value-of select='@id'/>", <xsl:value-of select='address/byte'/>)
		{
			// <xsl:value-of select='description/name'/>
			// <xsl:value-of select='description/description'/>
			// <xsl:value-of select='description/unit'/>

			public double getValue() { return <xsl:value-of select='normalize-space(value)'/>; }
		});
</xsl:template>

<xsl:template match='parameter' mode='list'>
  - <xsl:value-of select='@id'/> - <xsl:value-of select='description/name'/> - <xsl:value-of select='description/description'/> - <xsl:value-of select='description/unit'/>
</xsl:template>

</xsl:stylesheet>
